@startuml
' Актор — пользователь GophKeeper CLI
actor User

' Участники процесса
participant "GophKeeper CLI" as Client
database "Local DB" as LDB
participant "API Server" as Server

' Пользователь инициирует синхронизацию
User -> Client: Запуск синхронизации с указанием режима (server/client/interactive)

' Получение локальных секретов
Client -> LDB: Получить список всех локальных секретов
LDB --> Client: Список локальных секретов с датой обновления и типом

' Для каждого секрета выполняются шаги:
Client -> Server: Запрос версии секрета на сервере по secret_id
Server --> Client: Серверная версия секрета с датой обновления

Client -> Client: Сравнение даты обновления локальной и серверной версии

Client -> Client: Если локальная версия новее и режим interactive, запросить выбор пользователя
User --> Client: Выбор версии (локальная или серверная)

Client -> Client: Если режим server/client, выбрать версию по правилу режима

Client -> LDB: Обновить или вставить секрет в локальную базу с выбранной версией

Client -> LDB: Повторить процесс для каждого локального секрета

' Очистка локальной БД после завершения синхронизации
Client -> LDB: Очистить временные локальные секреты

Client --> User: Синхронизация завершена, все конфликты разрешены
@enduml
