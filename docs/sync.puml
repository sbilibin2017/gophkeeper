@startuml
actor User
participant "GophKeeper CLI" as Client
participant AESGCM
participant RSAEncryptor

User -> Client: Запуск синхронизации (online)

Client -> Client: Получение списка серверных секретов
Client -> Client: Получение ключа для каждого секрета

Client -> RSAEncryptor: Расшифровка AESKey
RSAEncryptor --> Client: AESKey

Client -> AESGCM: Расшифровка EncryptedPayload
AESGCM --> Client: plaintext

Client -> Client: Сравнение локальной и серверной версии
alt interactive режим
    Client -> User: Выбор версии (локальная/серверная)
    User --> Client: Выбор пользователя
else режим server/client
    Client -> Client: Выбор версии по правилу режима
end

Client --> User: Синхронизация завершена
@enduml