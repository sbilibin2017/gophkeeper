@startuml
actor Client
participant "API Server" as Server
participant "SecretTokenDecoder" as TokenDecoder
participant "SecretReader" as Reader
participant "SecretWriter" as Writer

== Сохранение секрета ==
Client -> Server: POST /save-secret {SecretResponse, Authorization: Bearer <token>}
Server -> TokenDecoder: GetFromRequest(request)
Server -> TokenDecoder: Parse(token_string)
Server -> Server: Decode JSON body -> SecretResponse
Server -> Writer: Save(ctx, secretID, userID, secretName, secretType, encryptedPayload, nonce, meta)
Server --> Client: 200 OK

== Получение секрета ==
Client -> Server: GET /get-secret?secret_name=<name> {Authorization: Bearer <token>}
Server -> TokenDecoder: GetFromRequest(request)
Server -> TokenDecoder: Parse(token_string)
Server -> Server: Get secret_name from query
Server -> Reader: Get(ctx, userID, secret_name)
Server --> Client: 200 OK {SecretResponse}

== Получение списка секретов ==
Client -> Server: GET /list-secrets {Authorization: Bearer <token>}
Server -> TokenDecoder: GetFromRequest(request)
Server -> TokenDecoder: Parse(token_string)
Server -> Reader: List(ctx, userID)
Server --> Client: 200 OK [{SecretResponse}, ...]
@enduml
