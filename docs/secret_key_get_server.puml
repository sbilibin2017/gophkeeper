@startuml
actor Client
participant "API Server" as Server
participant SecretKeyTokenDecoder
participant SecretKeyGetter
participant models

Client -> Server: GET /secret-key/get/{secret-id}
Server -> SecretKeyTokenDecoder: GetFromRequest(req)
SecretKeyTokenDecoder --> Server: tokenString

Server -> SecretKeyTokenDecoder: Parse(tokenString)
SecretKeyTokenDecoder --> Server: claims

Server -> Server: Get secret-id from URL
Server -> SecretKeyGetter: Get(ctx, secretID, claims.DeviceID)
SecretKeyGetter --> Server: secretKey

Server -> Server: Build SecretKeyResponse JSON
Server --> Client: SecretKeyResponse
@enduml