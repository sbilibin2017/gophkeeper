@startuml
actor Client
participant "API Server" as Server
participant SecretTokenDecoder
participant SecretReader
participant models

Client -> Server: GET /secret/get/{secret-id}
Server -> SecretTokenDecoder: GetFromRequest(req)
SecretTokenDecoder --> Server: tokenString

Server -> SecretTokenDecoder: Parse(tokenString)
SecretTokenDecoder --> Server: claims

Server -> Server: Get secret-id from URL
Server -> SecretReader: Get(ctx, claims.UserID, secretID)
SecretReader --> Server: secret

Server -> Server: Base64 encode payload & nonce
Server -> Server: Build SecretResponse JSON
Server --> Client: SecretResponse
@enduml
