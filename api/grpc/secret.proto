syntax = "proto3";

package gophkeeper;

option go_package = "github.com/sbilibin2017/gophkeeper/pkg/grpc";

import "google/protobuf/empty.proto";

// === Bank Card Secret ===

message AddSecretBankCardRequest {
  string secret_name = 1;
  string number = 2;
  string owner = 3;
  string exp = 4;
  string cvv = 5;
  string meta = 6;
}

message GetSecretBankCardRequest {
  string secret_name = 1;
}

message GetSecretBankCardResponse {
  string secret_name = 1;
  string secret_owner = 2;
  string number = 3;
  string owner = 4;
  string exp = 5;
  string cvv = 6;
  string meta = 7;
  string updated_at = 8;
}

message ListSecretBankCardResponse {
  repeated GetSecretBankCardResponse items = 1;
}

service SaveSecretBankCardService {
  rpc Save(AddSecretBankCardRequest) returns (google.protobuf.Empty);
}

service GetSecretBankCardService {
  rpc Get(GetSecretBankCardRequest) returns (GetSecretBankCardResponse);
}

service ListSecretBankCardService {
  rpc List(google.protobuf.Empty) returns (ListSecretBankCardResponse);
}

// === Binary Secret ===

message AddSecretBinaryRequest {
  string secret_name = 1;
  bytes data = 2;
  string meta = 3;
}

message GetSecretBinaryRequest {
  string secret_name = 1;
}

message GetSecretBinaryResponse {
  string secret_name = 1;
  string secret_owner = 2;
  bytes data = 3;
  string meta = 4;
  string updated_at = 5;
}

message ListSecretBinaryResponse {
  repeated GetSecretBinaryResponse items = 1;
}

service SaveSecretBinaryService {
  rpc Save(AddSecretBinaryRequest) returns (google.protobuf.Empty);
}

service GetSecretBinaryService {
  rpc Get(GetSecretBinaryRequest) returns (GetSecretBinaryResponse);
}

service ListSecretBinaryService {
  rpc List(google.protobuf.Empty) returns (ListSecretBinaryResponse);
}

// === Text Secret ===

message AddSecretTextRequest {
  string secret_name = 1;
  string content = 2;
  string meta = 3;
}

message GetSecretTextRequest {
  string secret_name = 1;
}

message GetSecretTextResponse {
  string secret_name = 1;
  string secret_owner = 2;
  string content = 3;
  string meta = 4;
  string updated_at = 5;
}

message ListSecretTextResponse {
  repeated GetSecretTextResponse items = 1;
}

service SaveSecretTextService {
  rpc Save(AddSecretTextRequest) returns (google.protobuf.Empty);
}

service GetSecretTextService {
  rpc Get(GetSecretTextRequest) returns (GetSecretTextResponse);
}

service ListSecretTextService {
  rpc List(google.protobuf.Empty) returns (ListSecretTextResponse);
}

// === UsernamePassword Secret ===

message AddSecretUsernamePasswordRequest {
  string secret_name = 1;
  string username = 2;
  string password = 3;
  string meta = 4;
}

message GetSecretUsernamePasswordRequest {
  string secret_name = 1;
}

message GetSecretUsernamePasswordResponse {
  string secret_name = 1;
  string secret_owner = 2;
  string username = 3;
  string password = 4;
  string meta = 5;
  string updated_at = 6;
}

message ListSecretUsernamePasswordResponse {
  repeated GetSecretUsernamePasswordResponse items = 1;
}

service SaveSecretUsernamePasswordService {
  rpc Save(AddSecretUsernamePasswordRequest) returns (google.protobuf.Empty);
}

service GetSecretUsernamePasswordService {
  rpc Get(GetSecretUsernamePasswordRequest) returns (GetSecretUsernamePasswordResponse);
}

service ListSecretUsernamePasswordService {
  rpc List(google.protobuf.Empty) returns (ListSecretUsernamePasswordResponse);
}
