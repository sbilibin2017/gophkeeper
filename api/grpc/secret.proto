syntax = "proto3";

package bankcard;

option go_package = "github.com/sbilibin2017/gophkeeper/pkg/grpc";

import "google/protobuf/empty.proto";


// EncryptedSecret represents a hybrid-encrypted secret:
message EncryptedSecret {
  string secret_name = 1;                 // Identifier for the secret
  string secret_type = 2;                 // Type of secret (e.g., bankcard, user, text)
  bytes ciphertext = 3;                   // AES-GCM encrypted data
  bytes hmac = 4;                         // HMAC-SHA256 over ciphertext
  bytes aes_key_enc = 5;                  // AES key encrypted using RSA-OAEP
  bytes nonce = 6;                        // AES-GCM nonce
  int64 timestamp = 7;                    // Unix timestamp of encryption
}

message GetSecretRequest {
  string secret_name = 1;
}

// Write service
service SecretWriteService {
  rpc Add(EncryptedSecret) returns (google.protobuf.Empty);
}

// Read service
service SecretReadService {
  rpc Get(GetSecretRequest) returns (EncryptedSecret);
  rpc List(google.protobuf.Empty) returns (stream EncryptedSecret);
}
