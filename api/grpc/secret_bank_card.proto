syntax = "proto3";

package gophkeeper;

option go_package = "github.com/sbilibin2017/gophkeeper/pkg/grpc";

// Запрос на сохранение банковской карты
message SecretBankCardSaveRequest {
  string secret_name = 1; // Название секрета (уникально в рамках владельца)
  string number = 2;      // Номер банковской карты (PAN)
  string owner = 3;       // Владелец секрета (логически необязательный)
  string exp = 4;         // Срок действия карты в формате MM/YY
  string cvv = 5;         // Код безопасности (3 или 4 цифры)
  string meta = 6;        // Дополнительные метаданные (JSON, может быть пустым)
}

// Ответ на сохранение (пустой)
message SecretBankCardSaveResponse {}

// Запрос для получения одной банковской карты по имени
message SecretBankCardGetRequest {
  string secret_name = 1;
}

// Ответ для получения одной банковской карты
message SecretBankCardGetResponse {
  string secret_name = 1;    
  string secret_owner = 2;   
  string number = 3;         
  string owner = 4;          
  string exp = 5;            
  string cvv = 6;            
  string meta = 7;           
  string updated_at = 8;     
}

// Запрос на получение списка банковских карт
message SecretBankCardListRequest {}

// Ответ со списком банковских карт
message SecretBankCardListResponse {
  repeated SecretBankCardGetResponse items = 1;
}

// Сервис управления банковскими картами
service SecretBankCardService {
  rpc List(SecretBankCardListRequest) returns (SecretBankCardListResponse);
  rpc Get(SecretBankCardGetRequest) returns (SecretBankCardGetResponse);
  rpc Save(SecretBankCardSaveRequest) returns (SecretBankCardSaveResponse);
}
